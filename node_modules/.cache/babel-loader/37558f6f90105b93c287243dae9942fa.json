{"remainingRequest":"/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/node_modules/babel-loader/lib/index.js!/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/src/utils/request.js","dependencies":[{"path":"/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/src/utils/request.js","mtime":1595163695052},{"path":"/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1584708646078},{"path":"/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/node_modules/babel-loader/lib/index.js","mtime":1585053728484}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCBzdG9yYWdlIGZyb20gJ3N0b3JlJzsKaW1wb3J0IG5vdGlmaWNhdGlvbiBmcm9tICdhbnQtZGVzaWduLXZ1ZS9lcy9ub3RpZmljYXRpb24nOwppbXBvcnQgeyBWdWVBeGlvcyB9IGZyb20gJy4vYXhpb3MnOwppbXBvcnQgeyBBQ0NFU1NfVE9LRU4gfSBmcm9tICdAL3N0b3JlL211dGF0aW9uLXR5cGVzJzsgLy8g5Yib5bu6IGF4aW9zIOWunuS+iwoKdmFyIHJlcXVlc3QgPSBheGlvcy5jcmVhdGUoewogIC8vIEFQSSDor7fmsYLnmoTpu5jorqTliY3nvIAKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0FQSV9CQVNFX1VSTCwKICB0aW1lb3V0OiA2MDAwIC8vIOivt+axgui2heaXtuaXtumXtAoKfSk7IC8vIOW8guW4uOaLpuaIquWkhOeQhuWZqAoKdmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uIGVycm9ySGFuZGxlcihlcnJvcikgewogIGlmIChlcnJvci5yZXNwb25zZSkgewogICAgdmFyIGRhdGEgPSBlcnJvci5yZXNwb25zZS5kYXRhOyAvLyDku44gbG9jYWxzdG9yYWdlIOiOt+WPliB0b2tlbgoKICAgIHZhciB0b2tlbiA9IHN0b3JhZ2UuZ2V0KEFDQ0VTU19UT0tFTik7CgogICAgaWYgKGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7CiAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcih7CiAgICAgICAgbWVzc2FnZTogJ0ZvcmJpZGRlbicsCiAgICAgICAgZGVzY3JpcHRpb246IGRhdGEubWVzc2FnZQogICAgICB9KTsKICAgIH0KCiAgICBpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEgJiYgIShkYXRhLnJlc3VsdCAmJiBkYXRhLnJlc3VsdC5pc0xvZ2luKSkgewogICAgICBub3RpZmljYXRpb24uZXJyb3IoewogICAgICAgIG1lc3NhZ2U6ICdVbmF1dGhvcml6ZWQnLAogICAgICAgIGRlc2NyaXB0aW9uOiAnQXV0aG9yaXphdGlvbiB2ZXJpZmljYXRpb24gZmFpbGVkJwogICAgICB9KTsKCiAgICAgIGlmICh0b2tlbikgewogICAgICAgIHN0b3JlLmRpc3BhdGNoKCdMb2dvdXQnKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfTsgLy8gcmVxdWVzdCBpbnRlcmNlcHRvcgoKCnJlcXVlc3QuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICB2YXIgdG9rZW4gPSBzdG9yYWdlLmdldChBQ0NFU1NfVE9LRU4pOyAvLyDlpoLmnpwgdG9rZW4g5a2Y5ZyoCiAgLy8g6K6p5q+P5Liq6K+35rGC5pC65bim6Ieq5a6a5LmJIHRva2VuIOivt+agueaNruWunumZheaDheWGteiHquihjOS/ruaUuQoKICBpZiAodG9rZW4pIHsKICAgIGNvbmZpZy5oZWFkZXJzWydBY2Nlc3MtVG9rZW4nXSA9IHRva2VuOwogIH0KCiAgcmV0dXJuIGNvbmZpZzsKfSwgZXJyb3JIYW5kbGVyKTsgLy8gcmVzcG9uc2UgaW50ZXJjZXB0b3IKCnJlcXVlc3QuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKfSwgZXJyb3JIYW5kbGVyKTsKdmFyIGluc3RhbGxlciA9IHsKICB2bToge30sCiAgaW5zdGFsbDogZnVuY3Rpb24gaW5zdGFsbChWdWUpIHsKICAgIFZ1ZS51c2UoVnVlQXhpb3MsIHJlcXVlc3QpOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgcmVxdWVzdDsKZXhwb3J0IHsgaW5zdGFsbGVyIGFzIFZ1ZUF4aW9zLCByZXF1ZXN0IGFzIGF4aW9zIH07"},{"version":3,"sources":["/Users/xuedixuedi/lxdThings/Code/github/mesh-frontend/src/utils/request.js"],"names":["axios","store","storage","notification","VueAxios","ACCESS_TOKEN","request","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","errorHandler","error","response","data","token","get","status","message","description","result","isLogin","dispatch","then","setTimeout","window","location","reload","Promise","reject","interceptors","use","config","headers","installer","vm","install","Vue"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,OAAP,MAAoB,OAApB;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,SAASC,YAAT,QAA6B,wBAA7B,C,CAEA;;AACA,IAAMC,OAAO,GAAGN,KAAK,CAACO,MAAN,CAAa;AAC3B;AACAC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,oBAFM;AAG3BC,EAAAA,OAAO,EAAE,IAHkB,CAGb;;AAHa,CAAb,CAAhB,C,CAMA;;AACA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC9B,MAAIA,KAAK,CAACC,QAAV,EAAoB;AAClB,QAAMC,IAAI,GAAGF,KAAK,CAACC,QAAN,CAAeC,IAA5B,CADkB,CAElB;;AACA,QAAMC,KAAK,GAAGf,OAAO,CAACgB,GAAR,CAAYb,YAAZ,CAAd;;AACA,QAAIS,KAAK,CAACC,QAAN,CAAeI,MAAf,KAA0B,GAA9B,EAAmC;AACjChB,MAAAA,YAAY,CAACW,KAAb,CAAmB;AACjBM,QAAAA,OAAO,EAAE,WADQ;AAEjBC,QAAAA,WAAW,EAAEL,IAAI,CAACI;AAFD,OAAnB;AAID;;AACD,QAAIN,KAAK,CAACC,QAAN,CAAeI,MAAf,KAA0B,GAA1B,IAAiC,EAAEH,IAAI,CAACM,MAAL,IAAeN,IAAI,CAACM,MAAL,CAAYC,OAA7B,CAArC,EAA4E;AAC1EpB,MAAAA,YAAY,CAACW,KAAb,CAAmB;AACjBM,QAAAA,OAAO,EAAE,cADQ;AAEjBC,QAAAA,WAAW,EAAE;AAFI,OAAnB;;AAIA,UAAIJ,KAAJ,EAAW;AACThB,QAAAA,KAAK,CAACuB,QAAN,CAAe,QAAf,EAAyBC,IAAzB,CAA8B,YAAM;AAClCC,UAAAA,UAAU,CAAC,YAAM;AACfC,YAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD,WAFS,EAEP,IAFO,CAAV;AAGD,SAJD;AAKD;AACF;AACF;;AACD,SAAOC,OAAO,CAACC,MAAR,CAAejB,KAAf,CAAP;AACD,CA1BD,C,CA4BA;;;AACAR,OAAO,CAAC0B,YAAR,CAAqB1B,OAArB,CAA6B2B,GAA7B,CAAiC,UAAAC,MAAM,EAAI;AACzC,MAAMjB,KAAK,GAAGf,OAAO,CAACgB,GAAR,CAAYb,YAAZ,CAAd,CADyC,CAEzC;AACA;;AACA,MAAIY,KAAJ,EAAW;AACTiB,IAAAA,MAAM,CAACC,OAAP,CAAe,cAAf,IAAiClB,KAAjC;AACD;;AACD,SAAOiB,MAAP;AACD,CARD,EAQGrB,YARH,E,CAUA;;AACAP,OAAO,CAAC0B,YAAR,CAAqBjB,QAArB,CAA8BkB,GAA9B,CAAkC,UAAClB,QAAD,EAAc;AAC9C,SAAOA,QAAQ,CAACC,IAAhB;AACD,CAFD,EAEGH,YAFH;AAIA,IAAMuB,SAAS,GAAG;AAChBC,EAAAA,EAAE,EAAE,EADY;AAEhBC,EAAAA,OAFgB,mBAEPC,GAFO,EAEF;AACZA,IAAAA,GAAG,CAACN,GAAJ,CAAQ7B,QAAR,EAAkBE,OAAlB;AACD;AAJe,CAAlB;AAOA,eAAeA,OAAf;AAEA,SACE8B,SAAS,IAAIhC,QADf,EAEEE,OAAO,IAAIN,KAFb","sourcesContent":["import axios from 'axios'\nimport store from '@/store'\nimport storage from 'store'\nimport notification from 'ant-design-vue/es/notification'\nimport { VueAxios } from './axios'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\n\n// 创建 axios 实例\nconst request = axios.create({\n  // API 请求的默认前缀\n  baseURL: process.env.VUE_APP_API_BASE_URL,\n  timeout: 6000 // 请求超时时间\n})\n\n// 异常拦截处理器\nconst errorHandler = (error) => {\n  if (error.response) {\n    const data = error.response.data\n    // 从 localstorage 获取 token\n    const token = storage.get(ACCESS_TOKEN)\n    if (error.response.status === 403) {\n      notification.error({\n        message: 'Forbidden',\n        description: data.message\n      })\n    }\n    if (error.response.status === 401 && !(data.result && data.result.isLogin)) {\n      notification.error({\n        message: 'Unauthorized',\n        description: 'Authorization verification failed'\n      })\n      if (token) {\n        store.dispatch('Logout').then(() => {\n          setTimeout(() => {\n            window.location.reload()\n          }, 1500)\n        })\n      }\n    }\n  }\n  return Promise.reject(error)\n}\n\n// request interceptor\nrequest.interceptors.request.use(config => {\n  const token = storage.get(ACCESS_TOKEN)\n  // 如果 token 存在\n  // 让每个请求携带自定义 token 请根据实际情况自行修改\n  if (token) {\n    config.headers['Access-Token'] = token\n  }\n  return config\n}, errorHandler)\n\n// response interceptor\nrequest.interceptors.response.use((response) => {\n  return response.data\n}, errorHandler)\n\nconst installer = {\n  vm: {},\n  install (Vue) {\n    Vue.use(VueAxios, request)\n  }\n}\n\nexport default request\n\nexport {\n  installer as VueAxios,\n  request as axios\n}\n"]}]}